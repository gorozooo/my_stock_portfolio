/* ==========================
   スマホファースト設計
   HTML / CSS / JS 分離
   全体背景は透明
   スクロール計算を安定化（iOS対策含む）
   視認性アップ（区切り・ハイライト・フォーカス表現）
   ========================== */

/* --------------------------------
   可視領域を正しく使うためのCSS変数
---------------------------------- */
:root{
  --vh: 1vh;
  --navbar-h: 64px;
  --bottom-tab-h: 72px;
  --page-pad: 16px;
}

/* ===== main（ページ全体で縦スクロール） ===== */
main{
  padding: 88px 16px calc(var(--bottom-tab-h) + 24px);
  overflow: visible;
  min-height: calc((var(--vh) * 100) - var(--navbar-h));
}

/* --------------------------
   ベースコンテナ
--------------------------- */
.portfolio-container{
  width:100%;
  box-sizing:border-box;
  padding:var(--page-pad);
  background:transparent;
  display:flex;
  flex-direction:column;
}

/* ==========================
   証券会社タブ
========================== */
.broker-tabs-wrapper{
  display:flex;
  justify-content:center;
  gap:8px;
  padding:6px 10px;
  position:sticky;
  top: var(--navbar-h);
  z-index:150;
  background:#fff;
  border-bottom:1px solid #e5e7eb;
  box-shadow:0 2px 8px rgba(15,23,42,.04);
  overflow-x:auto;
  scroll-behavior:smooth;
}
.broker-tabs-wrapper::-webkit-scrollbar{ display:none; }

.broker-tab{
  padding:8px 14px;
  border:1px solid var(--border, #ddd);
  background:#f8fafc;
  border-radius:14px;
  cursor:pointer;
  flex-shrink:0;
  white-space:nowrap;
  font-size:13px;
  font-weight:700;
  color:#0f172a;
  transition:all .2s ease;
}
.broker-tab.active{
  background:linear-gradient(135deg, rgba(0,123,255,.8), rgba(0,255,255,.6));
  border-color: rgba(0,123,255,.8);
  color:#fff;
  box-shadow:0 0 8px rgba(0,123,255,.5);
}

/* ==========================
   横スクロール外枠
========================== */
.broker-horizontal-wrapper{
  display:flex;
  flex-direction:row;
  width:100%;
  background:transparent;
  overflow:hidden;
  scroll-behavior:smooth;
  height:calc(100vh - var(--navbar-h) - var(--bottom-tab-h) - var(--page-pad));
}
@supports (height: 100dvh){
  .broker-horizontal-wrapper{
    height:calc(100dvh - var(--navbar-h) - var(--bottom-tab-h) - var(--page-pad));
  }
}
@supports (height: 100svh){
  .broker-horizontal-wrapper{
    height:calc(100svh - var(--navbar-h) - var(--bottom-tab-h) - var(--page-pad));
  }
}

.broker-section{
  flex:0 0 100%;
  width:100%;
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:0 8px 8px;
  box-sizing:border-box;
  background:transparent;
  scroll-snap-align:center;
}

/* ==========================
   口座チップ（信用/現物）
   → 固定をやめて本文内に配置
========================== */
.account-chips{
  position: static !important;
  top: auto !important;
  z-index: auto !important;
  background:#fff !important;
  border-bottom:1px solid #e5e7eb !important;
  margin: 8px 0 10px !important;
  padding: 8px 10px !important;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
.account-chip{
  flex:0 0 auto;
  padding:8px 12px;
  border:1px solid #ddd;
  border-radius:999px;
  font-size:12px;
  color:#0f172a;
  background:#f1f5f9;
  transition:all .15s ease;
}
.account-chip.is-active{
  border-color: rgba(0,200,255,.9);
  box-shadow:0 0 8px rgba(0,200,255,.3);
  background:linear-gradient(135deg, rgba(0,123,255,.25), rgba(0,255,255,.18));
}

/* スペーサ無効化 */
.after-account-chips{ height:0 !important; }

/* ==========================
   口座サマリー
========================== */
.account-summary{
  display:grid;
  grid-template-columns:1fr;
  row-gap:6px;
  padding:8px 10px;
  margin:0 2px 8px;
  border:1px dashed #ddd;
  border-radius:10px;
  background:#fff;
  font-size:12px;
  color:#334155;
}
.summary-pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  background:#f1f5f9;
  color:#0f172a;
  border:1px solid #cbd5e1;
  font-size:12px;
}
.summary-pill.profit-pos{ color:#16a34a; }
.summary-pill.profit-neg{ color:#dc2626; }

/* ==========================
   株カード
========================== */
.broker-cards-wrapper{
  display:flex;
  flex-direction:column;
  flex:1 1 auto;
  min-height:0;
  overflow-y:auto;
  gap:8px;
  padding:0 2px 6px;
  background:transparent;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior-y:contain;
}
.stock-card-wrapper{ width:100%; display:flex; justify-content:center; }
.stock-card{
  position:relative;
  padding:10px;
  border:1px solid #e5e7eb;
  border-radius:10px;
  background:#fff;
  color:#0f172a;
  font-size:12px;
  width:96%;
  max-width:520px;
  transition:all .2s ease;
}
.stock-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:6px;
  font-size:13px;
  font-weight:700;
}
.stock-name{ color:#0f172a; }
.stock-code{
  color:#475569;
  border:1px solid #cbd5e1;
  border-radius:6px;
  padding:2px 6px;
}
.stock-row{
  display:flex;
  justify-content:space-between;
  margin:3px 0;
  font-size:12px;
  color:#475569;
}
.stock-row span:last-child{ color:#0f172a; }
.stock-row.gain.positive span:last-child{ color:#16a34a; font-weight:700; }
.stock-row.gain.negative span:last-child{ color:#dc2626; font-weight:700; }

/* ==========================
   編集・売却ボタン
========================== */
.card-actions button{
  padding:6px 12px;
  border-radius:6px;
  font-weight:700;
  font-size:.9rem;
  border:1px solid #cbd5e1;
  color:#fff;
  background:linear-gradient(180deg, rgba(0,123,255,.85), rgba(0,123,255,.6));
}
.card-actions .sell-btn{
  background:linear-gradient(180deg, rgba(220,53,69,.9), rgba(220,53,69,.65));
}

/* ==========================
   レスポンシブ
========================== */
@media (min-width:768px){
  .broker-section{ flex:0 0 50%; min-width:50%; }
  .stock-card{ padding:12px; font-size:13px; max-width:520px; width:94%; }
}
@media (min-width:1024px){
  .broker-section{ flex:0 0 33.333%; min-width:33.333%; }
  .stock-card{ padding:14px; font-size:14px; max-width:560px; width:90%; }
}