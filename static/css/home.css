:root{
  --bg:#0b0f1a; --fg:#e8eeff; --muted:#94a3b8;
  --glass:rgba(255,255,255,.06); --line:rgba(255,255,255,.14);
  --pri:#6ea8ff; --acc:#00ffd1; --good:#26d07c; --bad:#ff5b6e;
  --radius:14px;
}
*{-webkit-tap-highlight-color:transparent}
body{
  background: radial-gradient(1200px 600px at 20% -10%, #132035 0%, #0b0f1a 55%) fixed;
  color:var(--fg);
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
}
.glass{
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  border:1px solid var(--line);
  backdrop-filter: blur(14px);
  box-shadow: 0 8px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
}
section{ margin:14px 12px; }

/* ===== AIヘッダー ===== */
.ai-header{ padding:14px; }
.ai-title{ font-weight:700; letter-spacing:.2px; margin-bottom:6px; }
.ai-note{ margin:6px 0 10px; color:var(--fg); line-height:1.55; }
.ai-tools{ margin-top:8px; display:flex; gap:10px; flex-wrap:wrap; }
.btn.ghost{
  border:1px solid var(--pri); color:var(--pri); background:transparent;
  padding:10px 14px; border-radius:12px; min-height:42px;
  font-size:0.95rem; touch-action:manipulation;
}

/* 提案リスト：2カラム（チェック / 本文＋バー＋優先度） */
.ai-actions{ margin:0; padding:0; list-style:none; color:var(--muted); }
.ai-actions .ai-item{
  display:grid;
  grid-template-columns:40px 1fr;
  column-gap:10px; row-gap:4px;
  padding:10px 8px; border-radius:12px;
  border:1px solid rgba(255,255,255,.08);
  background: rgba(255,255,255,.03);
  margin:8px 0;
}
.ai-actions .ai-check{
  background:transparent; border:1px solid rgba(255,255,255,.18);
  width:36px; height:36px; border-radius:8px;
  line-height:34px; display:grid; place-items:center;
  cursor:pointer; color:#9fb5ff; font-size:18px;
  touch-action:manipulation;
}
.ai-actions .ai-text{ display:flex; flex-direction:column; gap:6px; }
.ai-actions .msg{ color:var(--fg); line-height:1.6; }
.ai-actions .meta-row{
  display:flex; align-items:center; gap:10px;
}
.ai-actions .bar{
  position:relative; height:6px; flex:1;
  border-radius:999px; overflow:hidden;
  background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.12);
}
.ai-actions .bar span{
  display:block; height:100%;
  width: calc(var(--prio) * 100%); /* 0.00 - 1.00 */
  background:linear-gradient(90deg,#6ea8ff,#00ffd1);
}
.ai-actions .prio-badge{
  border:1px solid rgba(255,255,255,.18);
  padding:4px 8px; border-radius:999px;
  font-size:.85rem; white-space:nowrap; color:var(--muted);
}

/* ===== KPI ===== */
.kpi-grid{
  display:grid; grid-template-columns:1fr 1fr; gap:10px; padding:0 12px;
}
.kpi-card{
  border-radius:12px; padding:12px; background:var(--glass); border:1px solid var(--line);
  display:flex; flex-direction:column; justify-content:center; min-height:88px;
}
.kpi-label{ color:var(--muted); font-size:.85rem; }
.kpi-value{ font-size:1.3rem; font-weight:700; margin-top:4px; }
.kpi-value.pos{ color:var(--good); }
.kpi-value.neg{ color:var(--bad); }
.kpi-sub{ font-size:.85rem; margin-top:4px; }
.kpi-sub.muted{ color:var(--muted); }

/* === 2段式 ROI === */
.roi-card{ gap:6px; }
.roi-card .roi-row{
  display:flex; align-items:center; justify-content:space-between;
  padding:6px 8px; border-bottom:1px dashed rgba(255,255,255,.08);
  border-radius:10px;
}
.roi-card .roi-row:last-child{ border-bottom:0 }
.roi-card .eval{ background:linear-gradient(90deg, rgba(38,208,124,.12), transparent) }
.roi-card .liquid{ background:linear-gradient(90deg, rgba(80,160,255,.12), transparent) }
.roi-card .roi-label{ color:var(--muted); font-size:.9rem }
.roi-card .roi-value{ font-weight:800; font-size:1.2rem }
.roi-card .eval .roi-value.pos{ color:var(--good) }
.roi-card .eval .roi-value.neg{ color:var(--bad) }
.roi-card .liquid .roi-value{ color:#5db1ff }
.roi-card .roi-foot{
  margin-top:2px; font-size:.85rem; color:var(--muted);
  display:flex; gap:8px; align-items:center;
}
.roi-card .roi-gap{
  margin-left:auto; font-size:.8rem; padding:2px 6px; border-radius:999px;
  background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12)
}

/* ROIは横幅いっぱい */
.kpi-grid .roi-card{ grid-column:1 / -1; }

/* ===== 今すぐ現金化（ヒーロー＋3サマリー） ===== */
.liquidation{ padding:14px; }
.liq-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; gap:10px; }
.liq-head .title{ font-weight:700; font-size:1rem; }
.chip{
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.15);
  padding:6px 10px; border-radius:999px;
  font-size:.85rem; color:var(--muted);
}
.liq-hero{ text-align:left; }
.liq-total{ font-size:2rem; font-weight:800; margin-top:4px; letter-spacing:.3px; }
.li-sum-grid{ display:grid; grid-template-columns:1fr; gap:8px; margin-top:10px; }
.li-item{
  display:flex; gap:10px; align-items:center;
  padding:10px; border-radius:12px;
  background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1);
}
.li-ic{ width:26px; height:26px; border-radius:50%; flex-shrink:0; }
.li-ic.spot{background:linear-gradient(180deg,#2dd79b,#3fe09a);}
.li-ic.margin{background:linear-gradient(180deg,#ff8a8a,#ff6d6d);}
.li-ic.cash{background:linear-gradient(180deg,#6ea8ff,#56cfff);}
.li-label{color:var(--muted);font-size:.9rem;}
.li-value{font-weight:700;font-size:1.1rem;}
.li-value.neg{color:var(--bad);}
.li-value.pos{color:var(--good);}
.warn-list{margin-top:10px;}
.warn-item{font-size:.9rem;opacity:.9;}

/* ===== breakdown ===== */
.breakdown{padding:12px}
.dot{display:inline-block;width:10px;height:10px;border-radius:50%}
.dot.spot{background:#2dd79b}
.dot.margin{background:#ff6d6d}
.bd-gauge{position:relative;height:12px;border-radius:999px;overflow:hidden;
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);margin:6px 0 8px}
.bd-gauge-spot{height:100%;background:linear-gradient(90deg,#2dd79b,#49e28a)}
.bd-gauge-margin{height:100%;background:linear-gradient(90deg,#ff8a8a,#ff6d6d);float:right}
.bd-legend{display:flex;justify-content:space-between;opacity:.9;margin-bottom:8px}
.bd-donut-wrap{display:grid;grid-template-columns:180px 1fr;gap:16px;align-items:center}
.bd-donut{
  --spot:60; --margin:40;
  width:160px;height:160px;border-radius:50%;
  background: conic-gradient(#2dd79b calc(var(--spot)*1%), #ff6d6d 0);
  position:relative; box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);
}
.bd-donut::after{ content:""; position:absolute; inset:16px; border-radius:50%;
  background:rgba(0,0,0,.45); box-shadow:inset 0 0 0 1px rgba(255,255,255,.06); }
.bd-donut-hole{position:absolute; inset:16px; display:flex; flex-direction:column;
  align-items:center; justify-content:center; text-align:center; z-index:2}
.bd-donut-total{font-weight:700; font-size:1rem}
.bd-donut-caption{opacity:.8; font-size:.8rem; margin-top:2px}
.bd-legend-rows{list-style:none;margin:0;padding:0;display:grid;row-gap:4px}
.bd-legend-rows li{display:grid;grid-template-columns:16px 1fr auto;column-gap:8px;align-items:center}
.bd-legend-rows li.sub{opacity:.75;font-size:.95em}

/* ===== セクター / ストレス / キャッシュ ===== */
.sector-strip, .cash, .stress{padding:12px;}
.strip-title{margin-bottom:8px;color:var(--muted);font-size:.95rem;}
.strip-scroll{
  display:flex; gap:10px; overflow-x:auto; padding-bottom:4px;
  -webkit-overflow-scrolling: touch; scroll-snap-type: x proximity;
}
.sector-chip{
  min-width:160px; padding:10px; border-radius:12px;
  background:var(--glass); border:1px solid var(--line);
  scroll-snap-align: start;
}
.sec-name{font-weight:600;margin-bottom:4px;}
.sec-meta{display:flex;gap:8px;align-items:center;}
.sec-meta .mv{color:var(--muted);font-size:.85rem;}
/* ← テンプレに合わせて .share を採用（率の色付けは下の strong.pos/neg） */
.sec-meta .share{font-weight:700;}
.sec-sub{margin-top:2px;font-size:.85rem;opacity:.9}
.sec-sub strong.pos{color:var(--good);}
.sec-sub strong.neg{color:var(--bad);}

.cash-head{margin-bottom:8px;color:var(--muted);}
.stress-head{display:flex;justify-content:space-between;margin-bottom:8px;gap:8px;align-items:center;}
#stressSlider{width:100%;}

/* 改善要因ボックス */
.ai-insights{margin-top:10px;padding:10px;border:1px dashed rgba(255,255,255,.18);border-radius:10px;background:rgba(255,255,255,.04)}
.ai-insights .ins-title{font-weight:700;margin-bottom:6px;opacity:.95}
.ai-insights .ins-list{margin:0;padding-left:18px;opacity:.9}

/* ===== レスポンシブ ===== */
@media (max-width: 460px){
  .bd-donut-wrap{grid-template-columns:1fr;justify-items:center}
  .bd-legend-rows{width:100%}
  .kpi-grid{ grid-template-columns:1fr 1fr; }
}
@media (min-width: 960px){
  .kpi-grid{ grid-template-columns: repeat(4, 1fr); }
  .kpi-grid .roi-card{ grid-column:auto; }
  section{ margin:16px auto; max-width:1100px; }
  .li-sum-grid{ grid-template-columns:repeat(3,1fr); }
}