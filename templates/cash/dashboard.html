{% extends "base.html" %}
{% load humanize %}
{% block title %}ç¾é‡‘ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block content %}
<style>
  /* ä»®ã®ãƒŸãƒ‹ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆå¾Œã§ css/cash.css ã¸åˆ†é›¢ï¼‰ */
  .cash-wrap{max-width:980px;margin:12px auto 96px;padding:12px}
  .kpi-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  .card{padding:16px;border-radius:14px;background:rgba(255,255,255,.06);
        border:1px solid rgba(255,255,255,.10);backdrop-filter:blur(10px)}
  .kpi .v{font-size:20px;font-weight:700}
  .kpi .l{font-size:12px;color:#9aa4b2;margin-top:6px}
  .actions{display:flex;gap:8px;margin-top:14px}
  .actions a{flex:1;text-align:center;padding:10px 12px;border-radius:12px;
             border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);display:block}
  .empty{opacity:.7;text-align:center;padding:28px 8px}
</style>

<div class="cash-wrap">
  <h1 style="margin:6px 2px 12px">ğŸ’µ ç¾é‡‘ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>

  <!-- KPI -->
  <div class="kpi-grid">
    <div class="card kpi">
      <div class="v">{{ kpi.available|intcomma }} å††</div>
      <div class="l">ç·ä½™åŠ›</div>
    </div>
    <div class="card kpi">
      <div class="v">{{ kpi.cash_total|intcomma }} å††</div>
      <div class="l">ç·é ã‚Šé‡‘</div>
    </div>
    <div class="card kpi">
      <div class="v">{{ kpi.restricted|intcomma }} å††</div>
      <div class="l">ç·æ‹˜æŸ</div>
    </div>
    <div class="card kpi">
      <div class="v">{{ kpi.month_net|intcomma }} å††</div>
      <div class="l">ä»Šæœˆã®å…¥å‡ºé‡‘å·®åˆ†</div>
    </div>
  </div>

  <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div class="actions">
    <a href="{% url 'cash_dashboard' %}?action=deposit">å…¥é‡‘</a>
    <a href="{% url 'cash_dashboard' %}?action=withdraw">å‡ºé‡‘</a>
    <a href="{% url 'cash_dashboard' %}?action=transfer">æŒ¯æ›¿</a>
  </div>

  <!-- å£åº§ã‚«ãƒ¼ãƒ‰ï¼ˆå¾Œã§å£åº§ã”ã¨ã«ãƒ«ãƒ¼ãƒ—è¡¨ç¤ºï¼‰ -->
  {% if brokers %}
    <div style="margin-top:16px;display:grid;grid-template-columns:1fr;gap:12px">
      {% for b in brokers %}
      <div class="card">
        <div style="font-weight:600">{{ b.name }}</div>
        <div style="margin-top:6px;font-size:13px;color:#9aa4b2">
          æ®‹é«˜ {{ b.cash|intcomma }} / æ‹˜æŸ {{ b.restricted|intcomma }} / ä½™åŠ› {{ b.available|intcomma }}
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card empty">ã¾ãšã¯ç®¡ç†ç”»é¢ã‹ã‚‰å£åº§ã¨å°å¸³ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã¦ã„ã“ã†ã€‚</div>
  {% endif %}
</div>
{% endblock %}