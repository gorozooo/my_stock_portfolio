{% extends "base.html" %}
{% load humanize %}

{% block title %}ç¾é‡‘å°å¸³ã®å±¥æ­´{% endblock %}

{% block content %}
<h1 class="text-xl font-bold mb-3">ğŸ“œ ç¾é‡‘å°å¸³ã®å±¥æ­´</h1>

<!-- ãƒ•ã‚£ãƒ«ã‚¿ -->
<form method="get" class="grid grid-cols-2 gap-2 mb-3">
  <select name="broker" class="bg-slate-800 border border-slate-700 rounded px-2 py-2">
    {% with cur=params.broker|default:"ALL" %}
      <option value="ALL"  {% if cur == "ALL" %}selected{% endif %}>ã™ã¹ã¦ã®è¨¼åˆ¸</option>
      <option value="æ¥½å¤©" {% if cur == "æ¥½å¤©" %}selected{% endif %}>æ¥½å¤©</option>
      <option value="æ¾äº•" {% if cur == "æ¾äº•" %}selected{% endif %}>æ¾äº•</option>
      <option value="SBI" {% if cur == "SBI" %}selected{% endif %}>SBI</option>
    {% endwith %}
  </select>

  <select name="kind" class="bg-slate-800 border border-slate-700 rounded px-2 py-2">
    {% with cur=params.kind|default:"ALL" %}
      <option value="ALL"      {% if cur == "ALL" %}selected{% endif %}>ã™ã¹ã¦ã®ç¨®åˆ¥</option>
      <option value="DEPOSIT"  {% if cur == "DEPOSIT" %}selected{% endif %}>å…¥é‡‘</option>
      <option value="WITHDRAW" {% if cur == "WITHDRAW" %}selected{% endif %}>å‡ºé‡‘</option>
      <option value="XFER"     {% if cur == "XFER" %}selected{% endif %}>æŒ¯æ›¿</option>
      <option value="SYSTEM"   {% if cur == "SYSTEM" %}selected{% endif %}>ã‚·ã‚¹ãƒ†ãƒ </option>
    {% endwith %}
  </select>

  <input type="date" name="start" value="{{ params.start }}" class="bg-slate-800 border border-slate-700 rounded px-2 py-2">
  <input type="date" name="end"   value="{{ params.end }}"   class="bg-slate-800 border border-slate-700 rounded px-2 py-2">

  <input type="text" name="q" value="{{ params.q }}" placeholder="ãƒ¡ãƒ¢æ¤œç´¢"
         class="col-span-2 bg-slate-800 border border-slate-700 rounded px-3 py-2">

  <div class="col-span-2 flex gap-2">
    <button class="flex-1 bg-slate-700 hover:bg-slate-600 rounded px-3 py-2">é©ç”¨</button>
    <a href="{% url 'cash_history' %}" class="px-3 py-2 rounded bg-slate-800 border border-slate-700">ã‚¯ãƒªã‚¢</a>
  </div>
</form>

<!-- é›†è¨ˆ -->
<div class="rounded-lg border border-slate-700 bg-slate-800/60 p-3 mb-3 text-sm">
  <div class="flex gap-3 flex-wrap">
    <div>åˆè¨ˆ: <span class="font-bold">{{ summary.total|intcomma }}</span> å††</div>
    <div>å…¥é‡‘: <span class="font-bold">{{ summary.deposit|intcomma }}</span> å††</div>
    <div>å‡ºé‡‘: <span class="font-bold">{{ summary.withdraw|intcomma }}</span> å††</div>
    <div>æŒ¯æ›¿(å…¥): <span class="font-bold">{{ summary.xfer_in|intcomma }}</span> å††</div>
    <div>æŒ¯æ›¿(å‡º): <span class="font-bold">{{ summary.xfer_out|intcomma }}</span> å††</div>
  </div>
</div>

<!-- ä¸€è¦§ï¼ˆåˆå›ãƒšãƒ¼ã‚¸ã‚’æç”»ã€ç¶šãã‚’ HTMX èª­ã¿è¾¼ã¿ï¼‰ -->
<div id="ledgerList">
  {% include "cash/_history_list.html" with page=page params=params %}
</div>

{% endblock %}