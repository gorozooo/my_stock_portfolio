{# templates/realized/monthly.html #}
{% extends "base.html" %}
{% load static %}
{% block title %}月別サマリー{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/realized.css' %}?v=10">
<style>.view-hidden{display:none!important} section{margin-top:12px}</style>
{% endblock %}

{% block content %}
<div class="pnl">
  <h1>月別サマリー</h1>

  <div class="fi fi-full mt-4">
    <input type="search" name="q" value="{{ q|default:'' }}" id="q"
           placeholder="ティッカー/名称で検索"
           hx-get="{% url 'realized_summary_period' %}"
           hx-target="#monthly-period"
           hx-trigger="keyup changed delay:300ms, search"
           hx-include="#q"
           class="w-full">
  </div>

  {# 期間まとめ（既存部分テンプレ再利用） #}
  <section id="monthly-period"
           hx-get="{% url 'realized_summary_period' %}?preset={{ preset|default:'LAST_12M' }}&freq=month&q={{ q|urlencode }}"
           hx-trigger="load"
           hx-swap="outerHTML">
    <div style="color:#94a3b8;padding:8px 0">読み込み中…</div>
  </section>

  {# 1枚目：月次サマリー（棒＋折れ線） #}
  <section id="monthly-chart"
           hx-get="{% url 'realized_chart_monthly_json' %}"
           hx-trigger="load"
           hx-swap="outerHTML">
    {% include "realized/_monthly_chart.html" %}
  </section>

  {# 2,3枚目：累積PnLとヒストグラム（既存） #}
  <section id="analysis-charts">
    {% include "realized/_analysis_charts.html" %}
  </section>
</div>
{% endblock %}