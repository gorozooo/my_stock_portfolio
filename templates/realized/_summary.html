{# templates/realized/_summary.html #}
{% load humanize %}

<div class="grid grid-cols-2 gap-3 md:grid-cols-4">
  {# --- å…¨ä½“ã‚µãƒãƒªãƒ¼ --- #}
  <div class="card"><div class="ttl">ä»¶æ•°</div><div class="val">{{ agg.n|intcomma }}</div></div>
  <div class="card"><div class="ttl">æ•°é‡åˆè¨ˆ</div><div class="val">{{ agg.qty|intcomma }}</div></div>
  <div class="card"><div class="ttl">æ‰‹æ•°æ–™åˆè¨ˆ</div><div class="val">Â¥{{ agg.fee|floatformat:0|intcomma }}</div></div>
  <div class="card"><div class="ttl">ğŸ“ˆPnLç´¯è¨ˆ</div>
    <div class="val {% if agg.pnl >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
      Â¥{{ agg.pnl|floatformat:0|intcomma }}
    </div>
  </div>

  <div class="card col-span-2 md:col-span-1"><div class="ttl">ğŸ’°ç¾é‡‘ãƒ•ãƒ­ãƒ¼ï¼ˆç¾ç‰©ï¼šç‰¹å®š/NISAï¼‰</div>
    <div class="val {% if agg.cash_spec >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
      Â¥{{ agg.cash_spec|floatformat:0|intcomma }}
    </div>
  </div>
  <div class="card col-span-2 md:col-span-1"><div class="ttl">ğŸ’°ç¾é‡‘ãƒ•ãƒ­ãƒ¼ï¼ˆä¿¡ç”¨ï¼‰</div>
    <div class="val {% if agg.cash_margin >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
      Â¥{{ agg.cash_margin|floatformat:0|intcomma }}
    </div>
  </div>
  <div class="card md:col-span-2"><div class="ttl">ğŸ’°ç¾é‡‘ãƒ•ãƒ­ãƒ¼åˆè¨ˆï¼ˆç¾ç‰©ï¼‹ä¿¡ç”¨ï¼‰</div>
    <div class="val {% if agg.cash_total >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
      Â¥{{ agg.cash_total|floatformat:0|intcomma }}
    </div>
  </div>
</div>

{# --- ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼åˆ¥ï¼ˆæ¸¡ã£ã¦ã„ã‚Œã°æç”»ï¼‰ --- #}
{% if agg_brokers %}
  <div class="mt-6 grid grid-cols-2 gap-3 md:grid-cols-4">
    {% for b in agg_brokers %}
      <div class="card">
        <div class="ttl">
          è¨¼åˆ¸ä¼šç¤¾:
          {% if b.broker == 'RAKUTEN' %}æ¥½å¤©
          {% elif b.broker == 'SBI' %}SBI
          {% elif b.broker == 'MATSUI' %}æ¾äº•
          {% else %}ãã®ä»–{% endif %}
        </div>
        <div class="text-xs text-slate-400 mb-1">
          ä»¶æ•° {{ b.n|intcomma }} / æ•°é‡ {{ b.qty|intcomma }} / æ‰‹æ•°æ–™ Â¥{{ b.fee|floatformat:0|intcomma }}
        </div>
        <div class="space-y-1">
          <div>ğŸ’°ç¾ç‰©:
            <span class="{% if b.cash_spec >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
              Â¥{{ b.cash_spec|floatformat:0|intcomma }}
            </span>
          </div>
          <div>ğŸ’°ä¿¡ç”¨:
            <span class="{% if b.cash_margin >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
              Â¥{{ b.cash_margin|floatformat:0|intcomma }}
            </span>
          </div>
          <div>ğŸ’°åˆè¨ˆ:
            <span class="{% if b.cash_total >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
              Â¥{{ b.cash_total|floatformat:0|intcomma }}
            </span>
          </div>
          <div>ğŸ“ˆPnL:
            <span class="{% if b.pnl >= 0 %}text-emerald-300{% else %}text-rose-300{% endif %}">
              Â¥{{ b.pnl|floatformat:0|intcomma }}
            </span>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endif %}

{# ã¡ã‚‡ã£ã¨ã—ãŸå…±é€šã‚¹ã‚¿ã‚¤ãƒ« #}
<style>
  .card{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);
        border-radius:14px;padding:12px}
  .ttl{font-size:12px;color:#a7b1d8;margin-bottom:4px}
  .val{font-size:22px;line-height:1.1}
</style>