{% extends 'base.html' %}
{% block title %}下タブ設定{% endblock %}

{% block content %}
<h2>下タブ設定</h2>

<!-- タブ追加フォーム -->
<div class="form-section">
  <h3>タブの追加</h3>
  <form method="post">
    {% csrf_token %}
    {{ tab_form.as_p }}
    <button type="submit" name="tab_submit">追加</button>
  </form>
</div>

<!-- サブメニュー追加フォーム -->
<div class="form-section">
  <h3>サブメニューの追加</h3>
  <form method="post">
    {% csrf_token %}
    {{ submenu_form.as_p }}
    <button type="submit" name="submenu_submit">追加</button>
  </form>
</div>

<!-- 既存タブ一覧 -->
<h3>既存タブ</h3>
<table>
  <thead>
    <tr>
      <th>順番</th>
      <th>タブ名</th>
      <th>アイコン</th>
      <th>URL</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
  {% for tab in tabs %}
    <tr style="background-color:#111; color:#fff;">
      <td>{{ tab.order }}</td>
      <td>{{ tab.name }}</td>
      <td>{{ tab.icon_class }}</td>
      <td>{% if tab.url_name %}{{ tab.url_name }}{% else %}{{ tab.url }}{% endif %}</td>
      <td>
        <a href="{% url 'edit_tab' tab.id %}">編集</a> |
        <a href="{% url 'delete_tab' tab.id %}">削除</a>
      </td>
    </tr>
    {% for submenu in tab.submenus.all %}
    <tr style="background-color:#222; color:#aaa;">
      <td>↳ {{ submenu.order }}</td>
      <td>{{ submenu.name }}</td>
      <td>{{ submenu.icon_class }}</td>
      <td>{% if submenu.url_name %}{{ submenu.url_name }}{% else %}{{ submenu.url }}{% endif %}</td>
      <td>
        <a href="{% url 'edit_submenu' submenu.id %}">編集</a> |
        <a href="{% url 'delete_submenu' submenu.id %}">削除</a>
      </td>
    </tr>
    {% endfor %}
  {% endfor %}
  </tbody>
</table>
{% endblock %}
