{% extends "base.html" %}
{% load static %}

{% block title %}今日の作戦ボード{% endblock %}

{% block content %}
  <header class="adv-header">
    <div class="wrap">
      <div class="date-row">
        <div class="date" id="dateLabel"></div>
        <div class="pill status" id="statusPill" aria-live="polite">—</div>
      </div>

      <div class="summary">
        <div class="pill"><strong class="trend-badge" id="trendBadge"></strong></div>
        <div class="pill">今週のテーマ：<span class="theme-strip" id="themeStrip"></span></div>
        <div class="pill">再現率 <strong id="adherence">--%</strong></div>
      </div>
    </div>
  </header>

  <main class="container" role="main">
    <h2 class="section-title">おすすめ（5件）</h2>
    <section class="cards" id="cards" aria-live="polite"></section>
    <div class="foot">
      <button class="btn ghost" id="reorderBtn" aria-pressed="false">🔀 並び替え</button>
      <a class="btn" href="#" id="moreBtn">📉 他の候補を見る</a>
    </div>
  </main>

  <style>
    .date-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:6px;
      flex-wrap:wrap;
      gap:4px;
    }
    .pill.status{
      font-weight:700;
      padding:4px 10px;
      border-radius:999px;
      font-size:0.82rem;
    }
    .pill.status.live{
      background:rgba(16,185,129,.18);
      border:1px solid rgba(16,185,129,.35);
      color:#b7f7df;
    }
    .pill.status.demo{
      background:rgba(245,158,11,.18);
      border:1px solid rgba(245,158,11,.35);
      color:#ffe3b2;
    }
  </style>

  <!-- APIエンドポイントをサーバ側URLから注入 -->
  <script>
    window.ADVISOR_API_BOARD  = "{% url 'advisor_board' %}";           // ✅ /advisor/api/board/
    window.ADVISOR_API_ACTION = "{% url 'advisor_record_action' %}";   // ✅ /advisor/api/action/
    window.ADVISOR_API_REMIND = "{% url 'advisor_create_reminder' %}"; // ✅ /advisor/api/remind/
  </script>

  <link rel="stylesheet" href="{% static 'advisor/board.css' %}?v=3" />
  <script src="{% static 'advisor/board.js' %}?v=19"></script>
{% endblock %}