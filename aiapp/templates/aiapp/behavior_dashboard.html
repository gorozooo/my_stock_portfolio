{% extends "base.html" %}
{% load humanize %}

{% block title %}AI è¡Œå‹•ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block head %}
<style>
  :root{
    /* POP palette */
    --bg:#fff7fb;
    --bg2:#f5fbff;
    --paper:#ffffff;
    --ink:#111827;
    --sub:#475569;

    --pink:#ff3d8d;
    --orange:#ff7a18;
    --yellow:#ffd400;
    --mint:#21e6c1;
    --sky:#2bb7ff;
    --violet:#7c3aed;

    --win:#16a34a;
    --lose:#ef4444;
    --flat:#64748b;

    --line:rgba(17,24,39,.12);
    --shadow: 0 12px 30px rgba(17,24,39,.10);
    --shadow2: 0 8px 18px rgba(17,24,39,.08);

    --r:22px;
  }

  body{
    background:
      radial-gradient(circle at 12% 10%, rgba(43,183,255,.18), transparent 55%),
      radial-gradient(circle at 90% 0%, rgba(255,61,141,.16), transparent 60%),
      radial-gradient(circle at 20% 95%, rgba(255,212,0,.18), transparent 55%),
      linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
    color:var(--ink);
  }

  .wrap{
    max-width:920px;
    margin:0 auto;
    padding:14px 12px 88px;
  }

  /* =========================
     BIG POP HEADER
     ========================= */
  .poster{
    position:relative;
    background:var(--paper);
    border:1px solid var(--line);
    border-radius: calc(var(--r) + 6px);
    box-shadow: var(--shadow);
    padding:16px 14px 14px;
    overflow:hidden;
  }
  .poster:before{
    content:"";
    position:absolute;
    inset:-70px -70px auto auto;
    width:260px;height:260px;
    border-radius:50%;
    background:
      radial-gradient(circle at 30% 35%, rgba(255,61,141,.65), transparent 55%),
      radial-gradient(circle at 70% 70%, rgba(43,183,255,.55), transparent 58%),
      radial-gradient(circle at 35% 75%, rgba(255,212,0,.45), transparent 62%);
    transform:rotate(8deg);
    pointer-events:none;
  }
  .poster:after{
    content:"";
    position:absolute;
    inset:auto auto -90px -90px;
    width:280px;height:280px;
    border-radius:60px;
    background:
      radial-gradient(circle at 30% 30%, rgba(33,230,193,.55), transparent 60%),
      radial-gradient(circle at 70% 70%, rgba(255,122,24,.45), transparent 60%);
    transform:rotate(-10deg);
    pointer-events:none;
  }

  .posterTop{
    position:relative;
    z-index:1;
    display:flex;
    justify-content:space-between;
    gap:10px;
    align-items:flex-start;
  }

  .logo{
    display:flex;
    align-items:center;
    gap:10px;
    font-weight:1000;
    letter-spacing:.2px;
    font-size:18px;
  }
  .logoMark{
    width:38px;height:38px;
    border-radius:14px;
    background:
      linear-gradient(135deg, rgba(255,61,141,.95), rgba(255,122,24,.90));
    box-shadow: 0 0 0 6px rgba(255,61,141,.12);
    display:grid;
    place-items:center;
    color:#fff;
    font-size:18px;
  }

  .posterSub{
    margin-top:8px;
    font-size:12px;
    font-weight:800;
    color:rgba(17,24,39,.72);
    line-height:1.55;
  }

  .metaRow{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:10px;
  }
  .chip{
    display:inline-flex;
    align-items:center;
    gap:7px;
    padding:7px 10px;
    border-radius:999px;
    border:1px solid rgba(17,24,39,.12);
    background:#fff;
    box-shadow: 0 3px 10px rgba(17,24,39,.06);
    font-size:12px;
    font-weight:950;
    white-space:nowrap;
  }
  .chip b{font-variant-numeric: tabular-nums;}
  .chip.pink{background:rgba(255,61,141,.10);border-color:rgba(255,61,141,.22);}
  .chip.sky{background:rgba(43,183,255,.12);border-color:rgba(43,183,255,.22);}
  .chip.mint{background:rgba(33,230,193,.14);border-color:rgba(33,230,193,.22);}
  .chip.yellow{background:rgba(255,212,0,.18);border-color:rgba(255,212,0,.26);}
  .chip.violet{background:rgba(124,58,237,.10);border-color:rgba(124,58,237,.18);}

  /* =========================
     FAST TICKER (iPhone OK)
     ========================= */
  .ticker{
    position:relative;
    z-index:1;
    margin-top:12px;
    border-radius:18px;
    border:2px dashed rgba(17,24,39,.18);
    background:
      linear-gradient(90deg,
        rgba(255,61,141,.14),
        rgba(255,212,0,.14),
        rgba(33,230,193,.14),
        rgba(43,183,255,.14)
      );
    overflow:hidden;
  }

  .tickerHead{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    padding:8px 10px 0 10px;
    font-size:11px;
    font-weight:1000;
    color:rgba(17,24,39,.70);
  }

  .tickerLane{
    overflow:hidden;
    padding:10px 10px 12px 10px;
    touch-action:manipulation;
  }

  .tickerTrack{
    display:inline-flex;
    gap:10px;
    white-space:nowrap;
    will-change: transform;
    transform: translate3d(0,0,0);
    animation: ticker-move var(--dur, 12s) linear infinite;
  }
  .tickerLane.pause .tickerTrack{ animation-play-state: paused; }

  .tag{
    display:inline-flex;
    align-items:center;
    gap:7px;
    padding:7px 11px;
    border-radius:999px;
    background:#fff;
    border:1px solid rgba(17,24,39,.12);
    box-shadow: 0 2px 8px rgba(17,24,39,.06);
    font-size:12px;
    font-weight:1000;
    color:#0f172a;
  }
  .tagDot{
    width:10px;height:10px;border-radius:3px;
    background: linear-gradient(135deg, var(--orange), var(--pink));
  }
  .sep{
    width:6px;height:6px;border-radius:50%;
    background: rgba(17,24,39,.22);
    align-self:center;
  }

  @keyframes ticker-move{
    from{ transform: translate3d(var(--from, 0px),0,0); }
    to{ transform: translate3d(var(--to, -600px),0,0); }
  }

  /* =========================
     MAIN GRID
     ========================= */
  .grid{
    margin-top:12px;
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap:10px;
  }
  @media (max-width: 560px){
    .grid{ grid-template-columns: 1fr; }
  }

  .card{
    background:var(--paper);
    border:1px solid var(--line);
    border-radius: var(--r);
    box-shadow: var(--shadow2);
    padding:12px 12px;
  }

  .cardTitle{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    font-size:13px;
    font-weight:1100;
    margin-bottom:8px;
  }

  .badge{
    font-size:11px;
    font-weight:1100;
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(17,24,39,.12);
    background:rgba(17,24,39,.04);
    white-space:nowrap;
  }

  /* =========================
     POP GAUGE (quirky)
     ========================= */
  .gauge{
    border-radius:18px;
    border:1px solid rgba(17,24,39,.10);
    background:
      radial-gradient(circle at 15% 10%, rgba(255,212,0,.18), transparent 55%),
      #fff;
    padding:10px 10px;
  }
  .gaugeTop{
    display:flex;
    align-items:flex-end;
    justify-content:space-between;
    gap:10px;
  }
  .big{
    font-size:22px;
    font-weight:1200;
    letter-spacing:.2px;
    font-variant-numeric: tabular-nums;
  }
  .small{
    font-size:11px;
    font-weight:900;
    color:rgba(17,24,39,.68);
  }

  .bar{
    height:14px;
    border-radius:999px;
    background: rgba(17,24,39,.08);
    overflow:hidden;
    margin-top:8px;
    border:1px solid rgba(17,24,39,.08);
  }
  .bar > i{
    display:block;
    height:100%;
    width: var(--p, 0%);
    border-radius:999px;
    background: linear-gradient(90deg, rgba(255,61,141,.95), rgba(255,212,0,.95), rgba(33,230,193,.95));
  }

  .kpiRow{
    display:grid;
    grid-template-columns: repeat(2, minmax(0,1fr));
    gap:8px;
    margin-top:10px;
  }
  .kpi{
    border-radius:16px;
    border:1px solid rgba(17,24,39,.10);
    background:#fff;
    padding:10px 10px;
  }
  .kpiLabel{
    font-size:11px;
    font-weight:1000;
    color:rgba(17,24,39,.62);
    margin-bottom:6px;
  }
  .kpiVal{
    font-size:16px;
    font-weight:1200;
    font-variant-numeric: tabular-nums;
  }

  /* =========================
     "WEIRD BUT USEFUL" blocks
     ========================= */
  .list{
    display:flex;
    flex-direction:column;
    gap:8px;
  }

  .note{
    border-radius:18px;
    border:1px dashed rgba(17,24,39,.20);
    background:
      linear-gradient(0deg, rgba(255,255,255,.96), rgba(255,255,255,.96)),
      radial-gradient(circle at 20% 10%, rgba(255,61,141,.16), transparent 55%),
      radial-gradient(circle at 80% 90%, rgba(43,183,255,.14), transparent 60%);
    padding:10px 10px;
  }
  .noteHead{
    display:flex;
    align-items:center;
    gap:8px;
    font-size:11px;
    font-weight:1200;
    color:rgba(17,24,39,.70);
    margin-bottom:6px;
  }
  .num{
    width:24px;height:24px;
    border-radius:12px;
    display:grid;
    place-items:center;
    background: rgba(255,212,0,.28);
    border:1px solid rgba(255,212,0,.35);
    font-weight:1200;
  }
  .noteBody{
    font-size:13px;
    font-weight:1000;
    line-height:1.55;
  }

  .kv{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:8px;
  }
  @media (max-width: 560px){
    .kv{ grid-template-columns: 1fr; }
  }
  .kvRow{
    border-radius:16px;
    border:1px solid rgba(17,24,39,.10);
    background:#fff;
    padding:10px 10px;
    display:flex;
    justify-content:space-between;
    gap:10px;
  }
  .kvKey{
    font-size:12px;
    font-weight:1100;
    color:rgba(17,24,39,.72);
  }
  .kvVal{
    font-size:12px;
    font-weight:1200;
    text-align:right;
  }

  /* =========================
     W/L confetti sequence
     ========================= */
  .seq{
    display:flex;
    flex-wrap:wrap;
    gap:6px;
  }
  .pill{
    width:34px;height:30px;
    border-radius:15px;
    display:grid;
    place-items:center;
    font-weight:1200;
    border:1px solid rgba(17,24,39,.12);
    background:#fff;
    box-shadow: 0 2px 8px rgba(17,24,39,.05);
  }
  .pill.win{ background: rgba(22,163,74,.16); border-color: rgba(22,163,74,.32); }
  .pill.lose{ background: rgba(239,68,68,.15); border-color: rgba(239,68,68,.30); }
  .pill.flat{ background: rgba(100,116,139,.12); border-color: rgba(100,116,139,.26); }

  .streak{
    margin-top:8px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:8px;
    font-size:12px;
    font-weight:1200;
  }
  .streak strong{
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(17,24,39,.12);
    background:rgba(17,24,39,.05);
    font-variant-numeric: tabular-nums;
  }

  /* =========================
     Recent trades
     ========================= */
  .trade{
    border-radius:18px;
    border:1px solid rgba(17,24,39,.10);
    background:#fff;
    padding:10px 10px;
  }
  .tradeTop{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .code{
    font-weight:1200;
    font-variant-numeric: tabular-nums;
  }
  .lbl{
    font-size:11px;
    font-weight:1200;
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(17,24,39,.12);
  }
  .lbl.win{ background: rgba(22,163,74,.16); border-color: rgba(22,163,74,.32); }
  .lbl.lose{ background: rgba(239,68,68,.15); border-color: rgba(239,68,68,.30); }
  .lbl.flat{ background: rgba(100,116,139,.12); border-color: rgba(100,116,139,.26); }

  .tradeMid{
    margin-top:6px;
    display:flex;
    align-items:flex-end;
    justify-content:space-between;
    gap:10px;
  }
  .pl{
    font-weight:1200;
    font-variant-numeric: tabular-nums;
  }
  .pl.pos{ color: var(--win); }
  .pl.neg{ color: var(--lose); }

  .meta{
    font-size:11px;
    color:rgba(17,24,39,.55);
    text-align:right;
    white-space:nowrap;
  }

  /* Empty */
  .empty{
    margin-top:12px;
    border-radius: calc(var(--r) + 8px);
    border:2px dashed rgba(17,24,39,.18);
    background:#fff;
    box-shadow: var(--shadow2);
    padding:16px 14px;
  }
  .emptyTitle{
    font-size:14px;
    font-weight:1200;
    margin-bottom:6px;
  }
  .emptySub{
    font-size:12px;
    font-weight:900;
    color:rgba(17,24,39,.65);
    line-height:1.6;
  }
</style>

<script>
  // âœ… iPhoneã§ã€Œ2ç§’ã«ã—ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„ã€å•é¡Œã®æœ¬ä½“:
  // durationå›ºå®šã§ã¯ãªã "è·é›¢ Ã· é€Ÿåº¦(px/s)" ã§æ±ºã‚ã‚‹ã€‚
  // ã•ã‚‰ã« iOS ã®é…å»¶ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å‚™ãˆã¦è¤‡æ•°å› apply ã™ã‚‹ã€‚
  document.addEventListener("DOMContentLoaded", () => {
    const lane = document.querySelector("[data-ticker-lane]");
    const track = document.querySelector("[data-ticker-track]");
    if (!lane || !track) return;

    const speedPx = 210; // â˜… ã“ã“ã‚’ä¸Šã’ã‚‹ã¨ç¢ºå®Ÿã«é€Ÿããªã‚‹ï¼ˆiPhoneã§ã‚‚åŠ¹ãï¼‰
    const minDur  = 4;
    const maxDur  = 26;

    const apply = () => {
      const laneW  = lane.clientWidth || 320;
      const trackW = track.scrollWidth || 800;

      const from = laneW;      // å³å¤–ã‹ã‚‰é–‹å§‹
      const to   = -trackW;    // å·¦å¤–ã¸æŠœã‘ã‚‹
      const dist = from - to;  // laneW + trackW

      let dur = dist / speedPx;
      dur = Math.max(minDur, Math.min(maxDur, dur));

      track.style.setProperty("--from", from + "px");
      track.style.setProperty("--to", to + "px");
      track.style.setProperty("--dur", dur + "s");
    };

    apply();
    setTimeout(apply, 80);
    setTimeout(apply, 220);
    setTimeout(apply, 600);

    window.addEventListener("resize", () => setTimeout(apply, 80));
    document.addEventListener("visibilitychange", () => { if (!document.hidden) setTimeout(apply, 120); });

    const pauseOn = () => lane.classList.add("pause");
    const pauseOff = () => lane.classList.remove("pause");

    lane.addEventListener("touchstart", pauseOn, {passive:true});
    lane.addEventListener("touchend", pauseOff, {passive:true});
    lane.addEventListener("touchcancel", pauseOff, {passive:true});
    lane.addEventListener("mousedown", pauseOn);
    lane.addEventListener("mouseup", pauseOff);
    lane.addEventListener("mouseleave", pauseOff);
  });
</script>
{% endblock %}

{% block content %}
<div class="wrap">

  <!-- POP POSTER -->
  <div class="poster">
    <div class="posterTop">
      <div>
        <div class="logo">
          <div class="logoMark">ğŸˆ</div>
          è¡Œå‹•ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆãƒãƒƒãƒ—ç‰ˆï¼‰
        </div>
        <div class="posterSub">
          â€œæœªæ¥ã£ã½ã•â€ã¯æ¨ã¦ãŸã€‚<br>
          ä»£ã‚ã‚Šã« <b>è¦‹ãŸç¬é–“ã‚ã‹ã‚‹</b>ãƒ»<b>ã‚¯ã‚»ãŒåˆºã•ã‚‹</b> ã‚’å„ªå…ˆã—ãŸã€‚
        </div>

        <div class="metaRow">
          <span class="chip pink">ğŸ“… <b>{{ today_label|default:"-" }}</b></span>
          <span class="chip sky">ğŸ“‚ files <b>{{ sim_files|default:0 }}</b></span>
          <span class="chip mint">ğŸ§  model <b>{% if model.has_model %}READY{% else %}NONE{% endif %}</b></span>
          <span class="chip yellow">ğŸ¯ç†è§£åº¦ <b>{{ understanding_label|default:"-" }}</b></span>
          <span class="chip violet">ğŸ§·streak <b>{{ streak_label|default:"none" }}</b></span>
        </div>
      </div>
    </div>

    <!-- TICKER -->
    <div class="ticker" style="margin-top:12px;">
      <div class="tickerHead">
        <div>æœ¬æ—¥ã®ãƒ†ãƒ­ãƒƒãƒ—{% if ticker_date %}ï¼ˆ{{ ticker_date }}ï¼‰{% endif %}</div>
        <div>é•·æŠ¼ã—ã§åœæ­¢</div>
      </div>
      <div class="tickerLane" data-ticker-lane>
        <div class="tickerTrack" data-ticker-track>
          {% if ticker_lines %}
            {% for line in ticker_lines %}
              <span class="tag"><span class="tagDot"></span>{{ line }}</span><span class="sep"></span>
            {% endfor %}
            {% for line in ticker_lines %}
              <span class="tag"><span class="tagDot"></span>{{ line }}</span><span class="sep"></span>
            {% endfor %}
          {% else %}
            <span class="tag"><span class="tagDot"></span>ãƒ†ãƒ­ãƒƒãƒ—æœªç”Ÿæˆï¼šä»Šæ—¥ã®ä¸€è¨€ãŒæµã‚Œã‚‹</span><span class="sep"></span>
            <span class="tag"><span class="tagDot"></span>é€Ÿåº¦ã¯ â€œè·é›¢Ã·é€Ÿåº¦â€ è¨ˆç®—ï¼ˆiPhoneã§åŠ¹ãï¼‰</span><span class="sep"></span>
            <span class="tag"><span class="tagDot"></span>WLãŒå¢—ãˆã‚‹ã»ã©ã€ã‚¯ã‚»ãŒæ¿ƒããªã‚‹</span><span class="sep"></span>
            <span class="tag"><span class="tagDot"></span>ãƒ†ãƒ­ãƒƒãƒ—æœªç”Ÿæˆï¼šä»Šæ—¥ã®ä¸€è¨€ãŒæµã‚Œã‚‹</span><span class="sep"></span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  {% if not has_data %}
    <div class="empty">
      <div class="emptyTitle">ã¾ã ãƒ‡ãƒ¼ã‚¿ãŒ0 ğŸ¥š</div>
      <div class="emptySub">
        ã“ã“ã¯ â€œè¡Œå‹•ã®ã‚¯ã‚»â€ ã‚’è‚²ã¦ã‚‹å ´æ‰€ã€‚<br>
        ã¾ãšã¯ã‚·ãƒŸãƒ¥ãƒ¬â†’è©•ä¾¡â†’å­¦ç¿’ã§ <b>win/lose</b> ã‚’å¢—ã‚„ã™ã¨ã€ä¸€æ°—ã«é¢ç™½ããªã‚‹ã€‚
      </div>
    </div>
  {% else %}

    <!-- GRID 1 -->
    <div class="grid">
      <div class="card">
        <div class="cardTitle">
          <span>æˆç¸¾ã˜ã‚ƒãªã„ã€‚ã‚¯ã‚»ã®ä½“æ¸©</span>
          <span class="badge">WL={{ wl_total|default:0 }} / simulate={{ sim_total|default:0 }}</span>
        </div>

        {% with wr=win_rate|default_if_none:0 %}
        <div class="gauge" style="--p:{% if win_rate is not None %}{{ win_rate|floatformat:0 }}%{% else %}0%{% endif %};">
          <div class="gaugeTop">
            <div class="big">
              {% if win_rate is not None %}
                {{ win_rate|floatformat:1 }}%
              {% else %}
                -
              {% endif %}
            </div>
            <div class="small">å‹ç‡ï¼ˆwin/loseï¼‰</div>
          </div>
          <div class="bar"><i></i></div>

          <div class="kpiRow">
            <div class="kpi">
              <div class="kpiLabel">å¹³å‡R</div>
              <div class="kpiVal">{% if avg_r is not None %}{{ avg_r|floatformat:3 }}{% else %}-{% endif %}</div>
            </div>
            <div class="kpi">
              <div class="kpiLabel">å¹³å‡PL</div>
              <div class="kpiVal">{% if avg_pl is not None %}{{ avg_pl|floatformat:0|intcomma }}å††{% else %}-{% endif %}</div>
            </div>
            <div class="kpi">
              <div class="kpiLabel">ç†è§£åº¦ãƒ©ãƒ™ãƒ«</div>
              <div class="kpiVal">{{ understanding_label|default:"-" }}</div>
            </div>
            <div class="kpi">
              <div class="kpiLabel">ãƒ¢ãƒ‡ãƒ«</div>
              <div class="kpiVal">{% if model.has_model %}READY{% else %}NONE{% endif %}</div>
            </div>
          </div>
        </div>
        {% endwith %}

        {% if notes %}
          <div style="margin-top:10px;font-size:12px;font-weight:900;color:rgba(17,24,39,.68);line-height:1.6;">
            {% for n in notes %}â€¢ {{ n }}<br>{% endfor %}
          </div>
        {% endif %}
      </div>

      <div class="card">
        <div class="cardTitle">
          <span>å‹ã¡è² ã‘ã®â€œä¸¦ã³â€ã§è¦‹ã‚‹</span>
          <span class="badge">{{ streak_label|default:"none" }}</span>
        </div>

        <div class="seq">
          {% for s in sequence %}
            <div class="pill {{ s.label }}">{{ s.text }}</div>
          {% empty %}
            <div style="font-size:12px;font-weight:900;color:rgba(17,24,39,.65);">ã¾ã ä¸¦ã³ãŒã‚ã‚Šã¾ã›ã‚“</div>
          {% endfor %}
        </div>

        <div class="streak">
          <div>é€£ç¶šçŠ¶æ…‹</div>
          <strong>{{ streak_label|default:"none" }}</strong>
        </div>

        <div style="margin-top:10px;">
          <div class="cardTitle" style="margin-bottom:6px;">
            <span>ã‚¯ã‚»ã®åœ°å›³ï¼ˆé›‘ã«åˆºã™ï¼‰</span>
            <span class="badge">4è¦³ç‚¹</span>
          </div>
          <div class="kv">
            {% for b in bias_map %}
              <div class="kvRow">
                <div class="kvKey">{{ b.name }}</div>
                <div class="kvVal">{{ b.value }}</div>
              </div>
            {% empty %}
              <div style="font-size:12px;font-weight:900;color:rgba(17,24,39,.65);">ã¾ã åˆ¤å®šã§ãã¾ã›ã‚“</div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <!-- GRID 2 -->
    <div class="grid" style="margin-top:10px;">
      <div class="card">
        <div class="cardTitle">
          <span>AIã®ä»®èª¬ï¼ˆåˆºã•ã‚‹ã‚„ã¤ã ã‘ï¼‰</span>
          <span class="badge">max 6</span>
        </div>

        <div class="list">
          {% for h in hypotheses %}
            <div class="note">
              <div class="noteHead">
                <div class="num">{{ forloop.counter }}</div>
                <div>ä»®èª¬ {{ forloop.counter }}</div>
              </div>
              <div class="noteBody">{{ h }}</div>
            </div>
          {% empty %}
            <div style="font-size:12px;font-weight:900;color:rgba(17,24,39,.65);line-height:1.6;">
              ã¾ã ä»®èª¬ã‚’ä½œã‚Œã‚‹ã»ã©ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚WLã‚’å¢—ã‚„ã™ã¨ â€œåˆºã•ã‚‹æ–‡â€ ãŒå‡ºã¾ã™ã€‚
            </div>
          {% endfor %}
        </div>

        {% if wanted %}
          <div style="margin-top:10px;font-size:12px;font-weight:1000;color:rgba(17,24,39,.70);line-height:1.6;">
            <b>AIãŒæ¬²ã—ã„è¿½åŠ ãƒ‡ãƒ¼ã‚¿ï¼š</b><br>
            {% for w in wanted %}â€¢ {{ w }}<br>{% endfor %}
          </div>
        {% endif %}
      </div>

      <div class="card">
        <div class="cardTitle">
          <span>ç›´è¿‘ãƒ­ã‚°ï¼ˆè¦³å¯Ÿãƒ¢ãƒ¼ãƒ‰ï¼‰</span>
          <span class="badge">latest_behavior_side</span>
        </div>

        <div class="list">
          {% for t in recent_trades %}
            <div class="trade">
              <div class="tradeTop">
                <div class="code">{{ t.code }}</div>
                <div class="lbl {{ t.label }}">
                  {% if t.label == "win" %}WIN{% elif t.label == "lose" %}LOSE{% else %}FLAT{% endif %}
                </div>
              </div>

              <div class="tradeMid">
                {% if t.pl >= 0 %}
                  <div class="pl pos">+{{ t.pl|floatformat:0|intcomma }}å††</div>
                {% else %}
                  <div class="pl neg">{{ t.pl|floatformat:0|intcomma }}å††</div>
                {% endif %}
                <div class="meta">
                  {% if t.r is not None %}R={{ t.r|floatformat:3 }} / {% endif %}
                  {{ t.meta }}
                </div>
              </div>
            </div>
          {% empty %}
            <div style="font-size:12px;font-weight:900;color:rgba(17,24,39,.65);">
              ã¾ã  side ã®è¡ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚
            </div>
          {% endfor %}
        </div>

        <div style="margin-top:12px;font-size:12px;font-weight:900;color:rgba(17,24,39,.65);line-height:1.55;">
          <b>tipsï¼š</b> iPhoneã§é€Ÿåº¦ãŒå¤‰ã‚ã‚‰ãªã„æ™‚ã¯ã€durationå›ºå®šã˜ã‚ƒãªãã¦<br>
          â€œè·é›¢Ã·é€Ÿåº¦(px/s)â€ ãŒåŠ¹ãï¼ˆã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ã¯ãã®æ–¹å¼ï¼‰ã€‚
        </div>
      </div>
    </div>

  {% endif %}
</div>
{% endblock %}