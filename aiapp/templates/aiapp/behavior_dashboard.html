{% extends "base.html" %}
{% load humanize %}

{% block title %}AI Behavior Lab{% endblock %}

{% block head %}
<style>
:root{
  --bg:#020617;
  --panel:rgba(15,23,42,0.96);
  --glass:rgba(255,255,255,0.04);
  --fg:#e5e7eb;
  --muted:#94a3b8;
  --accent:#38bdf8;
  --warn:#f59e0b;
  --ok:#22c55e;
  --bad:#ef4444;
  --border:rgba(148,163,184,0.25);
}

body{background:var(--bg);color:var(--fg);}
.wrap{max-width:820px;margin:0 auto;padding:16px 14px 100px;}

/* ===== 共通カード ===== */
.card{
  margin-top:14px;
  padding:16px;
  border-radius:20px;
  border:1px solid var(--border);
  background:
    radial-gradient(circle at top left,rgba(56,189,248,0.15),transparent 55%),
    var(--panel);
  backdrop-filter:blur(18px);
}

/* ===== タイトル ===== */
.hero{
  padding:18px;
  border-radius:22px;
  background:
    linear-gradient(135deg,rgba(56,189,248,0.25),rgba(15,23,42,0.95));
  border:1px solid var(--border);
}
.hero h1{
  font-size:20px;
  font-weight:800;
  margin:0 0 6px 0;
}
.hero p{
  font-size:12px;
  color:var(--muted);
  line-height:1.6;
}

/* ===== 思考ブロック ===== */
.think-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
}
.think{
  padding:12px 14px;
  border-radius:14px;
  border:1px dashed var(--border);
  background:var(--glass);
  font-size:13px;
}
.think .label{
  font-size:11px;
  color:var(--muted);
  margin-bottom:4px;
}
.think .value{
  font-weight:600;
  line-height:1.6;
}

/* ===== メトリクス（非KPI） ===== */
.metric-grid{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:10px;
}
.metric{
  padding:12px;
  border-radius:16px;
  background:rgba(15,23,42,0.98);
  border:1px solid var(--border);
}
.metric .m-title{
  font-size:11px;
  color:var(--muted);
  margin-bottom:6px;
}
.metric .m-val{
  font-size:18px;
  font-weight:800;
  font-variant-numeric:tabular-nums;
}

/* ===== 傾向マップ ===== */
.map{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.map-row{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  border-bottom:1px dashed var(--border);
  padding-bottom:6px;
}
.map-row:last-child{border-bottom:none;}
.map-name{color:#e5e7eb;}
.map-val{color:var(--muted);}

/* ===== 未学習 ===== */
.empty{
  margin-top:24px;
  padding:18px;
  border-radius:16px;
  border:1px dashed var(--border);
  background:rgba(15,23,42,0.9);
  font-size:13px;
  color:var(--muted);
  line-height:1.7;
}
</style>
{% endblock %}

{% block content %}
<div class="wrap">

  <!-- HERO -->
  <div class="hero">
    <h1>AI Behavior Lab</h1>
    <p>
      ここは「成績表」ではありません。<br>
      AI があなたのトレードをどう“理解し始めているか”を、
      思考・仮説・偏りとして可視化する実験室です。
    </p>
  </div>

  {% if not has_data %}
    <div class="empty">
      まだ AI が学習できるだけの行動データがありません。<br>
      <br>
      ▸ AI Picks からシミュレーションを実行すると、<br>
      ▸ このページは「あなた専用の行動地図」に変化します。
    </div>
  {% else %}

  <!-- AIが今考えていること -->
  <div class="card">
    <h3>AI の現在の仮説</h3>
    <div class="think-grid">
      <div class="think">
        <div class="label">仮説 01</div>
        <div class="value">
          あなたは「勝率」よりも「一撃の大きさ」を無意識に優先している可能性があります。
        </div>
      </div>
      <div class="think">
        <div class="label">仮説 02</div>
        <div class="value">
          エントリーの方向性は安定していますが、撤退判断にばらつきが見られます。
        </div>
      </div>
    </div>
  </div>

  <!-- 学習メトリクス（非KPI） -->
  <div class="card">
    <h3>学習の進み具合</h3>
    <div class="metric-grid">
      <div class="metric">
        <div class="m-title">AI が観測した行動数</div>
        <div class="m-val">{{ total|default:"-" }}</div>
      </div>
      <div class="metric">
        <div class="m-title">現在の理解度（概算）</div>
        <div class="m-val">LOW → MID</div>
      </div>
      <div class="metric">
        <div class="m-title">再現性のあるパターン</div>
        <div class="m-val">2〜3</div>
      </div>
      <div class="metric">
        <div class="m-title">未解釈行動</div>
        <div class="m-val">多め</div>
      </div>
    </div>
  </div>

  <!-- 行動の偏り -->
  <div class="card">
    <h3>行動バイアス・マップ</h3>
    <div class="map">
      <div class="map-row">
        <div class="map-name">トレンド選好</div>
        <div class="map-val">順張り寄り</div>
      </div>
      <div class="map-row">
        <div class="map-name">損切り耐性</div>
        <div class="map-val">やや我慢型</div>
      </div>
      <div class="map-row">
        <div class="map-name">時間帯の癖</div>
        <div class="map-val">後場に集中</div>
      </div>
    </div>
  </div>

  <!-- 次にAIが見たいもの -->
  <div class="card">
    <h3>AI が次に欲しがっているデータ</h3>
    <ul style="font-size:13px;color:var(--muted);line-height:1.7;padding-left:18px;">
      <li>同一条件での「連続トレード」</li>
      <li>負けトレード後の行動</li>
      <li>迷った末に見送ったケース</li>
    </ul>
  </div>

  {% endif %}

</div>
{% endblock %}